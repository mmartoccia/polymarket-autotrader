# Progress Log - Bug Fixes

## Learnings
(Patterns discovered during implementation)

---

## Iteration 1 - US-BF-013: Disable ML mode temporarily
- Added USE_ML_MODEL=False flag to config/agent_config.py
- Updated bot/momentum_bot_v12.py to check config flag before environment variable
- Added startup log message: "ðŸš« ML mode disabled - using agent-only mode (USE_ML_MODEL=False)"
- Files changed:
  - config/agent_config.py (added USE_ML_MODEL flag)
  - bot/momentum_bot_v12.py (updated ML check logic and added startup logging)
- Learnings for future iterations:
  - Config flag takes precedence over environment variable (proper override hierarchy)
  - ML mode requires BOTH USE_ML_MODEL=True AND USE_ML_BOT=true env var
  - With USE_ML_MODEL=False, ML code path is completely skipped regardless of env var
  - Bot will now use agent-only decision making
  - Syntax checks passed for both modified files
---

## Iteration 2 - US-BF-014: Lower entry price threshold
- Added MAX_ENTRY = 0.25 global cap to config/agent_config.py
- Added EARLY_MAX_ENTRY = 0.30 to config for clarity (bot already had this value)
- Added validation in bot/momentum_bot_v12.py to enforce MAX_ENTRY before placing trades
- Files changed:
  - config/agent_config.py (added MAX_ENTRY and EARLY_MAX_ENTRY constants)
  - bot/momentum_bot_v12.py (added global entry price validation at line 2872-2881)
  - PRD.md (marked US-BF-014 complete)
  - test_entry_price.py (created test to verify entry price rejection)
- Learnings for future iterations:
  - MAX_ENTRY is enforced AFTER strategy selection but BEFORE correlation checks
  - Validation uses getattr() with default fallback for backward compatibility
  - Entry price cap reduces breakeven win rate from 52% to 51% (fee economics)
  - Test coverage: Created test_entry_price.py to verify rejection logic
  - All syntax checks passed for both modified files
---

## Iteration 3 - US-BF-015: Check and disable bull market overrides
- Added DISABLE_BULL_OVERRIDES = True flag to config/agent_config.py
- Implemented check_bull_market_overrides() function in bot/momentum_bot_v12.py
- Function checks if state/bull_market_overrides.json exists and logs appropriate warnings
- Files changed:
  - config/agent_config.py (added DISABLE_BULL_OVERRIDES flag with section and comments)
  - bot/momentum_bot_v12.py (added bull market override detection function and startup check)
  - PRD.md (marked US-BF-015 complete)
  - test_bull_overrides.py (created comprehensive test suite)
- Learnings for future iterations:
  - The bull_market_overrides.json file exists but was NOT being loaded (bot loads ralph_overrides.json instead)
  - Added preventive check to ensure overrides never accidentally get loaded
  - Startup logging provides three scenarios:
    1. File exists + disabled: WARNING with confirmation overrides ignored
    2. File exists + NOT disabled: ERROR alerting to dangerous config
    3. File doesn't exist: INFO message (normal state)
  - getattr() with default value ensures backward compatibility
  - Test coverage validates flag existence, file detection, and expected behavior
  - All syntax checks and tests passed
---
