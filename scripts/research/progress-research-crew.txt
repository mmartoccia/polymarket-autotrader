
## Iteration 22 - US-RC-013: Test win rate statistical significance
**Persona:** Dr. Sarah Chen (Probabilistic Mathematician)
**Completed:** 2026-01-16 20:15
**Files Changed:**
- scripts/research/statistical_significance.py (created, 575 lines)
- reports/sarah_chen/statistical_significance.md (generated)
- PRD-research-crew.md (marked US-RC-013 complete)

**Learnings:**
- Pattern: One-tailed binomial test using z-test approximation
  - H0: p = 0.50 (coin flip), H1: p > 0.50 (edge exists)
  - z = (p_obs - 0.50) / sqrt(0.50 * 0.50 / n)
  - p-value = P(Z > z) using standard normal CDF
- Pattern: 95% confidence interval using two-tailed critical value
  - CI = p_obs Â± 1.96 Ã— SE_obs
  - SE_obs = sqrt(p_obs * (1 - p_obs) / n)
  - Interpretation: "We are 95% confident true WR lies in this interval"
- Pattern: Sample size calculation for desired precision
  - n = (zÂ² Ã— p Ã— (1-p)) / EÂ²
  - For Â±2.5% margin at 95% confidence with p=0.58: n â‰ˆ 374 trades
  - Formula accounts for observed probability (not null hypothesis)
- Pattern: Verdict thresholds based on p-value and observed WR
  - NO EDGE: p â‰¥ 0.05 (fail to reject H0)
  - MARGINAL: p < 0.05 AND p_obs < 0.53 (small edge)
  - MODERATE: p < 0.05 AND 0.53 â‰¤ p_obs < 0.60 (profitable edge)
  - STRONG: p < 0.05 AND p_obs â‰¥ 0.60 (robust edge)
- Pattern: Standard normal CDF approximation using error function
  - Î¦(z) = 0.5 Ã— (1 + erf(z / sqrt(2)))
  - For one-tailed upper test: p-value = 1 - Î¦(z)
  - Built-in math.erf() provides accurate approximation
- Gotcha: Helper functions called from f-string must not use `self`
  - Bad: {self._get_interpretation(result)} in standalone function
  - Good: {_get_interpretation(result)} without self prefix
  - f-strings evaluate expressions in current scope, not class scope
- Gotcha: 58% WR with 100 trades is NOT significant at Î±=0.05
  - z = 1.6, p = 0.055 (marginally above threshold)
  - Need ~150 trades for 58% to be significant
  - Or need 60% WR with 100 trades (z = 2.0, p = 0.023)
- Context: Sample size adequacy thresholds
  - n < 30: INADEQUATE (z-test invalid)
  - 30 â‰¤ n < 100: MINIMAL (valid but low power)
  - 100 â‰¤ n < 384: ADEQUATE (good power)
  - n â‰¥ 384: EXCELLENT (high power, narrow CI)
- Context: Recommendations tailored to verdict
  - NO EDGE: Halt trading, investigate root cause
  - MARGINAL: Optimize fees, collect more data
  - MODERATE/STRONG: Continue trading, optimize sizing
- Context: Report serves multiple downstream researchers
  - Rita Stevens: Validates if edge is robust enough for current risk limits
  - Victor Ramanujan: Comparison to shadow strategy significance tests
  - Eleanor Nash: Strategic synthesis (confidence in profitability claim)

**Implementation Notes:**
- Created comprehensive statistical significance tester with 3 main classes:
  1. TradeLogParser: Reuses US-RC-001 parsing logic (ORDER + WIN/LOSS)
  2. StatisticalSignificanceTester: Implements z-test for proportion
  3. SignificanceResult: Dataclass storing all test results
- Z-test formula validated against known example:
  - Input: 100 trades, 58 wins (58% WR)
  - Expected: z â‰ˆ 1.6, p â‰ˆ 0.055 (NOT significant)
  - Actual: z = 1.6000, p = 0.0548 âœ“
- Report structure (10 sections):
  1. Executive summary (verdict, key metrics)
  2. Statistical test details (z-score, SE calculation)
  3. P-value interpretation (reject H0 or not)
  4. Confidence interval (95% CI with interpretation)
  5. Sample size analysis (adequacy assessment)
  6. Sample size requirement (Â±2.5% margin calculation)
  7. Recommendations (immediate actions based on verdict)
  8. Methodology (test selection, assumptions, violations)
  9. Statistical formulas reference (z-test, CI, sample size)
  10. Appendix (trade breakdown table)
- Exit code: 0 always (non-blocking, reports test result)
- Typecheck passed with py_compile
- Successfully handles no-data scenario (dev environment)
- Ready for production use on VPS with actual bot.log

**Key Finding:**
ðŸŸ¡ METHODOLOGY VALIDATED: Statistical significance test correctly implements one-tailed binomial test (z-test approximation). Formula tested: 58% WR with 100 trades â†’ z=1.60, p=0.055 (NOT significant at Î±=0.05). Sample size calculator accurate: 374 trades needed for Â±2.5% margin at 95% confidence. Report framework ready for production data.

---

